<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Music Style Player</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Parkinson&display=swap" rel="stylesheet">
        <style>
        /* General Reset and Layout */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Parkinsans', sans-serif;
            background-color: #121212;
            color: white;
            height: 100%;
            overflow: hidden;
        }

        /* Loader Styles */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #121212;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loader .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hide loader when page is loaded */
        .hide-loader {
            display: none;
        }

        /* Main Layout */
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* Header */
        #header {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #1F1F1F;
            justify-content: space-between;
        }

        /* Small Page Logo */
        #page-logo {
            height: 30px;
            width: auto;
        }

        /* Search Bar */
        #search-container {
            display: flex;
            align-items: center;
            background-color: #333;
            border-radius: 20px;
            padding: 5px 15px;
            width: 200px;
            transition: all 0.3s ease;
        }

        #search-bar {
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            outline: none;
            padding: 5px;
            width: 150px;
        }

        #search-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* Main Player */
        #player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        /* Song Info */
        #song-info {
            text-align: center;
            margin-bottom: 20px;
        }

        #song-name {
            font-size: 22px;
            font-weight: bold;
            margin: 10px 0;
        }

        #song-artist {
            font-size: 16px;
            color: #999;
        }

        #album-name {
            font-size: 14px;
            color: #888;
            margin-top: 5px;
        }

        /* Song List */
        #song-list {
            width: 100%;
            padding: 10px;
            background-color: #1F1F1F;
            border-radius: 10px;
            margin-bottom: 20px;
            border: none;
            color: white;
        }

        /* Album Image */
        #album-poster {
            width: 250px;
            height: 250px;
            background-size: cover;
            background-position: center;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        /* Controls */
        #controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
        }

        #controls button {
            background: none;
            border: none;
            color: white;
            font-size: 40px;
            cursor: pointer;
        }

        /* Progress Bar */
        #progress-bar {
            width: 100%;
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin: 10px 0;
            outline: none;
            cursor: pointer;
        }

        #progress-bar::-webkit-slider-thumb {
            background: #FF4081;
            border: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Quality Dropdown */
        #quality-select {
            background: #333;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 5px;
            font-size: 16px;
            margin-top: 15px;
        }

        /* Shuffle and Download Icon */
        #shuffle-btn {
            font-size: 30px;
            color: white;
            cursor: pointer;
            margin-right: 20px;
        }

        #download-btn {
            font-size: 30px;
            color: white;
            cursor: pointer;
        }

        /* Mobile Responsiveness */
        @media (max-width: 600px) {
            #search-container {
                width: 150px;
            }

            #song-list {
                width: 90%;
            }

            #song-name {
                font-size: 18px;
            }

            #song-artist {
                font-size: 14px;
            }

            #controls button {
                font-size: 30px;
            }

            #quality-select {
                font-size: 14px;
            }

            #album-poster {
                width: 200px;
                height: 200px;
            }

            #download-btn {
                font-size: 20px;
            }
        }

        /* Hide audio element */
        #audio {
            display: none;
        }
    </style>
</head>
<body>

    <!-- Loader -->
    <div class="loader" id="loader">
        <div class="spinner"></div>
    </div>

    <div class="container" id="content">
        <!-- Your existing HTML structure here -->
    </div>

    <!-- Audio Player (Hidden) -->
    <audio id="audio" controls></audio>

    <script>
        const queries = [
            'Telugu', 'SBP', 'Devi Sri Prasad', 'Mani Sharma', 'love', 'Anoop Rubens', 
            'S. P. Balasubrahmanyam', 'Ilaiyaraaja', 'K.J. Yesudas', 'M. M. Keeravani', 
            'Annamayya Keerthana', 'G.V. Prakash Kumar', 'Anurag Kulkarni', 'Mahesh Babu', 
            'Thaman S', 'Ram Miriyala', 'Bheems Ceciroleo', 'Yuvan Shankar Raja', 
            'Ramajogayya Sastry', 'new remix'
        ];

        let audio = document.getElementById("audio");
        let playIcon = document.getElementById("play-icon");
        let songList = document.getElementById("song-list");
        let progressBar = document.getElementById("progress-bar");
        let timeDisplay = document.getElementById("time-display");
        let qualitySelect = document.getElementById("quality-select");
        let currentSongIndex = 0;
        let songs = []; // Store song data from API response
        let currentQuality = "96"; // Default to 96 kbps

        // Auto-fetch random query and play the first song on page load
        window.onload = async function() {
            const randomQuery = queries[Math.floor(Math.random() * queries.length)];
            await searchSongs(randomQuery);
        }

        // Fetch songs based on search query
        async function searchSongs(query) {
            if (!query) return;

            try {
                let url = `https://saavn.dev/api/search/songs?query=${query}&page=1&limit=10`;
                const response = await fetch(url);
                const data = await response.json();

                // Check if data exists and is valid
                if (data && data.data && data.data.results) {
                    songs = data.data.results;
                    updateSongList();
                    
                    // Auto-play the first song after fetching the song list
                    if (songs.length > 0) {
                        currentSongIndex = 0; // Set the first song as the current song
                        playSong(); // Play the first song
                    }
                } else {
                    console.error('No songs found or invalid response:', data);
                }
            } catch (error) {
                console.error('Error fetching song data:', error);
            }
        }

        // Update song list dropdown
        function updateSongList() {
            songList.innerHTML = "<option value=''>Select a song</option>";
            songs.forEach((song, index) => {
                const option = document.createElement("option");
                option.value = index;
                option.innerHTML = song.name;
                songList.appendChild(option);
            });
        }

        // Play selected song
        function playSong() {
            if (songList.value !== "") {
                currentSongIndex = songList.value;
                loadSong();
                audio.play();
            }
        }

        // Load song info
        function loadSong() {
            const song = songs[currentSongIndex];
            const selectedQuality = qualitySelect.value;
            const qualityUrl = song.downloadUrl.find(url => url.quality === `${selectedQuality}kbps`).url;

            audio.src = qualityUrl;
            document.getElementById("song-name").innerText = song.name;
            document.getElementById("song-artist").innerText = song.artists.primary[0].name;
            document.getElementById("album-name").innerText = song.album.name;
            document.getElementById("album-poster").style.backgroundImage = `url(${song.image[2].url})`;
            playIcon.innerText = "pause";
        }

        // Toggle play/pause
        function togglePlay() {
            if (audio.paused) {
                audio.play();
                playIcon.innerText = "pause";
            } else {
                audio.pause();
                playIcon.innerText = "play_arrow";
            }
        }

        // Seek song through progress bar
        function seekSong() {
            let value = progressBar.value;
            let seekTime = (audio.duration * value) / 100;
            audio.currentTime = seekTime;
        }

        // Update progress bar as song plays
        audio.ontimeupdate = function() {
            let value = (audio.currentTime / audio.duration) * 100;
            progressBar.value = value;
            let currentTime = formatTime(audio.currentTime);
            timeDisplay.innerText = currentTime;
        }

        // Format time for display
        function formatTime(seconds) {
            let min = Math.floor(seconds / 60);
            let sec = Math.floor(seconds % 60);
            if (sec < 10) sec = "0" + sec;
            return `${min}:${sec}`;
        }

        // Shuffle songs in the list
        function shufflePlaylist() {
            songs = songs.sort(() => Math.random() - 0.5);
            updateSongList();
        }

        // Download the current song
        function downloadSong() {
            const song = songs[currentSongIndex];
            const selectedQuality = qualitySelect.value;
            const qualityUrl = song.downloadUrl.find(url => url.quality === `${selectedQuality}kbps`).url;
            window.location.href = qualityUrl;
        }
    </script>

</body>
</html>
